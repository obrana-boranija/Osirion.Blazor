@page "/admin"
@* @inject IGitHubCmsService CmsService
@using Osirion.Blazor.Services.GitHub *@

<PageTitle>Admin Panel - Osirion Blog</PageTitle>

<h1>Admin Panel</h1>

@* <div class="admin-actions">
    <div class="action-card">
        <h3>Cache Management</h3>
        <p>You can refresh the content cache to get the latest updates from GitHub.</p>
        <button class="btn btn-primary" @onclick="RefreshCache" disabled="@IsRefreshing">
            @if (IsRefreshing)
            {
                <span>Refreshing...</span>
            }
            else
            {
                <span>Refresh Cache</span>
            }
        </button>
    </div>
</div>

<div class="toast @(ShowToast ? "show" : "")">
    <div class="toast-header">
        <strong>Cache Refreshed</strong>
        <button @onclick="() => ShowToast = false">×</button>
    </div>
    <div class="toast-body">
        Content cache has been successfully refreshed.
    </div>
</div>

@code {
    private bool IsRefreshing { get; set; }
    private bool ShowToast { get; set; }

    private async Task RefreshCache()
    {
        IsRefreshing = true;
        try
        {
            await CmsService.RefreshCacheAsync();
            ShowToast = true;

            // Auto hide the toast after 3 seconds
            await Task.Delay(3000);
            ShowToast = false;
        }
        finally
        {
            IsRefreshing = false;
        }
    }
} *@