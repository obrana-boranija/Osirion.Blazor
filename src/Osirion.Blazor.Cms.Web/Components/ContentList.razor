@using Osirion.Blazor.Cms.Components
@using Osirion.Blazor.Cms.Domain.Repositories
<div class="@GetContentListClass()">
    @if (IsLoading && IsInteractive)
    {
        <div class="osirion-content-loading">
            <div class="osirion-spinner"></div>
            <p>@LoadingText</p>
        </div>
    }
    else if (ContentItems is null || !ContentItems.Any())
    {
        <div class="osirion-no-content">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <path d="M9 15h6"></path>
                <path d="M9 11h6"></path>
            </svg>
            <p>@NoContentText</p>
        </div>
    }
    else
    {
        <OsirionContentListSection Items="ContentItems" Layout="grid" PostCount="ItemsPerPage" Columns="3" />


        @if (ShowPagination && TotalPages > 1)
        {
            <div class="osirion-content-pagination">
                @if (CurrentPage > 1)
                {
                    <a href="@GetPaginationUrl(CurrentPage - 1)" class="osirion-pagination-link" @onclick="() => OnPageChanged(CurrentPage - 1)" @onclick:preventDefault>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </a>
                }

                @{
                    int startPage = Math.Max(1, CurrentPage - 2);
                    int endPage = Math.Min(TotalPages, startPage + 4);

                    if (endPage - startPage < 4 && TotalPages > 4)
                    {
                        startPage = Math.Max(1, endPage - 4);
                    }
                }

                @if (startPage > 1)
                {
                    <a href="@GetPaginationUrl(1)" class="osirion-pagination-link" @onclick="() => OnPageChanged(1)" @onclick:preventDefault>1</a>

                    if (startPage > 2)
                    {
                        <span class="osirion-pagination-ellipsis">...</span>
                    }
                }

                @for (int i = startPage; i <= endPage; i++)
                {
                    int pageNumber = i;
                    <a href="@GetPaginationUrl(pageNumber)"
                       class="osirion-pagination-link @(pageNumber == CurrentPage ? "osirion-active" : "")"
                       @onclick="() => OnPageChanged(pageNumber)"
                       @onclick:preventDefault>
                        @pageNumber
                    </a>
                }

                @if (endPage < TotalPages)
                {
                    if (endPage < TotalPages - 1)
                    {
                        <span class="osirion-pagination-ellipsis">...</span>
                    }

                    <a href="@GetPaginationUrl(TotalPages)" class="osirion-pagination-link" @onclick="() => OnPageChanged(TotalPages)" @onclick:preventDefault>@TotalPages</a>
                }

                @if (CurrentPage < TotalPages)
                {
                    <a href="@GetPaginationUrl(CurrentPage + 1)" class="osirion-pagination-link" @onclick="() => OnPageChanged(CurrentPage + 1)" @onclick:preventDefault>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                }
            </div>
        }
    }
</div>