@page "/blog"
@page "/blog/tag/{TagSlug}"
@page "/blog/category/{CategorySlug}"
@page "/{locale}/blog"
@page "/{locale}/blog/category/{CategorySlug}"
@page "/{locale}/blog/tag/{TagSlug}"
@using Osirion.Blazor.Cms.Components
@using Osirion.Blazor.Cms.Domain.Interfaces
@using Osirion.Blazor.Cms.Interfaces
@using Osirion.Blazor.Cms.Models
@inject IContentProvider ContentProvider
@attribute [StreamRendering]


<PageTitle>CMS Demo</PageTitle>

<h1>Content Management System Demo</h1>
<p class="lead">This page demonstrates the GitHub CMS integration with content from the repository.</p>

<div class="row">
    <!-- Main Content -->
    <div class="col-md-8">
        <nav aria-label="Content directories" class="mb-4">
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#blog-content" type="button" role="tab">Blog Posts</button>
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#docs-content" type="button" role="tab">Documentation</button>
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#all-content" type="button" role="tab">All Content</button>
            </div>
        </nav>

        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="blog-content" role="tabpanel">
                <h2>Latest Blog Posts</h2>
                <ContentList Directory="@Directory"
                             Category="@CategorySlug"
                             Tag="@TagSlug"
                             Locale="@Locale"
                             ItemsPerPage="5"
                             ShowPagination="true" />
            </div>
@*             <div class="tab-pane fade" id="docs-content" role="tabpanel">
                <h2>Documentation</h2>
                <ContentList Directory="docs" Tag="@TagSlug" Category="@CategorySlug" />
            </div>
            <div class="tab-pane fade" id="all-content" role="tabpanel">
                <h2>All Content</h2>
                <ContentList />
            </div> *@
        </div>
    </div>

    <!-- Sidebar -->
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Search Content</h5>
                <SearchBox Placeholder="Search articles..." />
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Navigation</h5>
                <DirectoryNavigation />
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Categories</h5>
                <CategoriesList ActiveCategory="@CategorySlug"
                                CategoryUrlFormatter="@(category => $"/{(locale is null ? $"{locale}/" : "")}blog/category/{category.Slug}")" />
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Popular Tags</h5>
                <TagCloud MaxTags="20"
                          ActiveTag="@TagSlug"
                          TagUrlFormatter="@(tag => $"/{(locale is null ? $"{locale}/" : "")}blog/tag/{tag.Slug}")" />
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Featured Content</h5>
                <ContentList FeaturedCount="3" />
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public string? CategorySlug { get; set; }

    [Parameter]
    public string? TagSlug { get; set; }

    [Parameter]
    public string? locale { get; set; }

    private string Directory => "blog";
    private string Locale => locale ?? "en";

    private string PageTitle =>
        !string.IsNullOrEmpty(CategorySlug) ? $"Category: {CategorySlug}" :
        !string.IsNullOrEmpty(TagSlug) ? $"Tag: {TagSlug}" :
        "Blog";
}